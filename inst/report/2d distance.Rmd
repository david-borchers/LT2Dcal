# 2D Distance Sampling
```{r, include=FALSE}
source("code.R")
b1 = c(4.945767, 0.714222); logphi1 = c(6.520254,4.754897) 
w1 = 1500; ystart1 = 1300
```
## Introduction
2D Distance Sampling builds on standard distance sampling by including the forward distance to the detected animal as well as the perpendicular distance. This removes the assumptions that the animals are uniformly distributed and that p(0) = 1, so this method is useful for situations where the other methods covered previously are not suitable. 

##Simulation - Non Uniform Distribution
We start by simulating attraction to the line using a half normal distribution with parameters `r exp(logphi)` and hazard rate detection function with parameters `r b`, as these are the best model for our real data.  
```{r, echo = F, warnings = F}
suppressWarnings(simdata <- MCR_2D(99,200))
bias_2d <- 100*(simdata$X2D - 200)/200
```
We then fitted a model using a half normal distribution for animal density and hazard detection function. We did not fit any other models for the purpose of efficiency. This gives a bias of `r mean(bias_2d)` \pm `r 1.96*sqrt(var(bias_2d)/length(bias_2d))`, so we can confirm it is unbiased. 
## Simulation - Comparison to Mark Recapture
Double Observer mark recapture methods are the current standard for estimating abundance of snow leopard prey. 
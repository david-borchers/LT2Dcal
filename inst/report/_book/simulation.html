<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Simulation | _main.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Simulation | _main.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Simulation | _main.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cross.html"/>
<link rel="next" href="real-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="cross.html"><a href="cross.html"><i class="fa fa-check"></i><b>2</b> Methods</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cross.html"><a href="cross.html#mark-recapture"><i class="fa fa-check"></i><b>2.1</b> Mark-Recapture</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="cross.html"><a href="cross.html#closed-populations"><i class="fa fa-check"></i><b>2.1.1</b> Closed populations</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="cross.html"><a href="cross.html#distance-sampling"><i class="fa fa-check"></i><b>2.2</b> Distance Sampling</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="cross.html"><a href="cross.html#line-transect-sampling"><i class="fa fa-check"></i><b>2.2.1</b> Line transect sampling</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="cross.html"><a href="cross.html#further-reading"><i class="fa fa-check"></i><b>2.3</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>3</b> Simulation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="simulation.html"><a href="simulation.html#simulation-scenarios"><i class="fa fa-check"></i><b>3.1</b> Simulation scenarios</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="simulation.html"><a href="simulation.html#initial-perpendicular-distance-distribution"><i class="fa fa-check"></i><b>3.1.1</b> Initial perpendicular distance distribution</a></li>
<li class="chapter" data-level="3.1.2" data-path="simulation.html"><a href="simulation.html#movement-after-first-detection"><i class="fa fa-check"></i><b>3.1.2</b> Movement after first detection</a></li>
<li class="chapter" data-level="3.1.3" data-path="simulation.html"><a href="simulation.html#imperfect-matching"><i class="fa fa-check"></i><b>3.1.3</b> Imperfect Matching</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="simulation.html"><a href="simulation.html#simulation-results"><i class="fa fa-check"></i><b>3.2</b> Simulation Results</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="simulation.html"><a href="simulation.html#uniform-animal-distribution"><i class="fa fa-check"></i><b>3.2.1</b> Uniform Animal Distribution</a></li>
<li class="chapter" data-level="3.2.2" data-path="simulation.html"><a href="simulation.html#avoiding-transect"><i class="fa fa-check"></i><b>3.2.2</b> Avoiding Transect</a></li>
<li class="chapter" data-level="3.2.3" data-path="simulation.html"><a href="simulation.html#attracted-to-transect"><i class="fa fa-check"></i><b>3.2.3</b> Attracted to Transect</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="simulation.html"><a href="simulation.html#further-reading-1"><i class="fa fa-check"></i><b>3.3</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="real-data.html"><a href="real-data.html"><i class="fa fa-check"></i><b>4</b> Real Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="real-data.html"><a href="real-data.html#mark-recapture-1"><i class="fa fa-check"></i><b>4.1</b> Mark Recapture</a></li>
<li class="chapter" data-level="4.2" data-path="real-data.html"><a href="real-data.html#summary"><i class="fa fa-check"></i><b>4.2</b> Summary</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulation" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Simulation<a href="simulation.html#simulation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Simulation studies have become indispensable in ecology and conservation research, providing a controlled and repeatable approach to evaluate the performance of estimation methods. In this study, we aimed to assess how each method performs using a range of scenarios with varying degrees of assumption compliance and violations. In each scenario, artificial datasets are created with with known population sizes, density patterns, detectability patterns, etc. to test the accuracy and precision of estimators.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="simulation.html#cb1-1" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;report.simulation.R&quot;</span>)</span>
<span id="cb1-2"><a href="simulation.html#cb1-2" tabindex="-1"></a><span class="fu">library</span>(knitr)</span></code></pre></div>
<div id="simulation-scenarios" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Simulation scenarios<a href="simulation.html#simulation-scenarios" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="initial-perpendicular-distance-distribution" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Initial perpendicular distance distribution<a href="simulation.html#initial-perpendicular-distance-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Perpendicular distance refers to the minimum distance to the transect line at which animals are detected. 3 different levels are considered: uniformly distributed, avoiding the line and attracted to the line.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="simulation.html#cb2-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb2-2"><a href="simulation.html#cb2-2" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb2-3"><a href="simulation.html#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="simulation.html#cb2-4" tabindex="-1"></a><span class="co"># uniformly distributed</span></span>
<span id="cb2-5"><a href="simulation.html#cb2-5" tabindex="-1"></a><span class="fu">plot</span>(xs, <span class="fu">pi.const</span>(<span class="at">x=</span>xs,<span class="at">logphi=</span><span class="cn">NA</span>,<span class="at">w=</span><span class="dv">1</span>),</span>
<span id="cb2-6"><a href="simulation.html#cb2-6" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">xlab=</span><span class="st">&#39;Perp. distance, x&#39;</span>,<span class="at">ylab=</span><span class="fu">expression</span>(<span class="fu">pi</span>(x)))</span>
<span id="cb2-7"><a href="simulation.html#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="simulation.html#cb2-8" tabindex="-1"></a><span class="co"># avoiding the line</span></span>
<span id="cb2-9"><a href="simulation.html#cb2-9" tabindex="-1"></a><span class="fu">plot</span>(xs, <span class="fu">pi.chnorm</span>(<span class="at">x=</span>xs,<span class="at">logphi=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.5</span>),<span class="at">w=</span><span class="dv">1</span>),</span>
<span id="cb2-10"><a href="simulation.html#cb2-10" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">xlab=</span><span class="st">&#39;Perp. distance, x&#39;</span>,<span class="at">ylab=</span><span class="fu">expression</span>(<span class="fu">pi</span>(x)))</span>
<span id="cb2-11"><a href="simulation.html#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="simulation.html#cb2-12" tabindex="-1"></a><span class="co"># attracted to the line</span></span>
<span id="cb2-13"><a href="simulation.html#cb2-13" tabindex="-1"></a><span class="fu">plot</span>(xs,<span class="fu">pi.norm</span>(<span class="at">x=</span>xs,<span class="at">logphi=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),<span class="at">w=</span><span class="dv">1</span>),</span>
<span id="cb2-14"><a href="simulation.html#cb2-14" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">xlab=</span><span class="st">&#39;Perp. distance, x&#39;</span>,<span class="at">ylab=</span><span class="fu">expression</span>(<span class="fu">pi</span>(x)))</span></code></pre></div>
<p><img src="_main_files/figure-html/initial%20perp.%20dist.%20distribution-1.png" width="672" /></p>
<div class="figure"><span style="display:block;" id="fig:distribution-plots"></span>
<img src="_main_files/figure-html/distribution-plots-1.png" alt="Potential Animal Distributions" width="672" />
<p class="caption">
Figure 3.1: Potential Animal Distributions
</p>
</div>
</div>
<div id="movement-after-first-detection" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Movement after first detection<a href="simulation.html#movement-after-first-detection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the mark recapture methods there are two detection occasions, which could be , for example, two observers on different decks of a boat or , as in the snow leopard prey data, two observers walking the transect at different times. Animal movement is not an issue for the first scenario as the animals move slowly in comparison to the boat, so will not move far enough to have different detection probabilities between the two observers. However, in our snow leopard prey example, there is 30 minutes between the first and second observer walking the transect so the animals could move significantly between the two observers. We consider two types of movement after the first detection: random movement and avoidant movement away from the transect. We based our simulation on Ibex movement data in Johansson <em>et al</em>. (2022), which shows that the distance moved follows roughly a log normal distribution with mean log(12) + 1.5 and standard deviation 1.5,</p>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-951a8d7f69e3b838262c" style="width:672px;height:840px;"></div>
<script type="application/json" data-for="htmlwidget-951a8d7f69e3b838262c">{"x":{"visdat":{"4b4036477d6":["function () ","plotlyVisDat"]},"cur_data":"4b4036477d6","attrs":{"4b4036477d6":{"x":{},"y":{},"mode":"markers","color":{},"size":{},"frame":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"x","range":[-1700.3850392997265,1756.7358769476414]},"yaxis":{"domain":[0,1],"automargin":true,"title":"y","range":[-10.485932193926455,624.75796189642062]},"hovermode":"closest","showlegend":true,"sliders":[{"currentvalue":{"prefix":"obs: ","xanchor":"right","font":{"size":16,"color":"rgba(204,204,204,1)"}},"steps":[{"method":"animate","args":[["1"],{"transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":false},"mode":"immediate"}],"label":"1","value":"1"},{"method":"animate","args":[["2"],{"transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":false},"mode":"immediate"}],"label":"2","value":"2"}],"visible":true,"pad":{"t":40}}],"updatemenus":[{"type":"buttons","direction":"right","showactive":false,"y":0,"x":0,"yanchor":"top","xanchor":"right","pad":{"t":60,"r":5},"buttons":[{"label":"Play","method":"animate","args":[null,{"fromcurrent":true,"mode":"immediate","transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":false}}]}]}]},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-470.67747041583061,23.203881084918976,-255.73413521051407,617.90588647127151,386.79257407784462,-929.88394424319267,1457.2256281971931,-470.74553593993187,-722.20703512430191,-798.61548021435738,673.0136401951313,430.95153197646141,23.178030550479889,-599.05411601066589,-167.40104705095291,304.36807870864868,599.82218742370605,508.47419872879982,104.79078069329262,-338.95321190357208,1204.7875463962555,-869.85121592879295,433.74356403946877,1395.7807585597038,-1543.2431794703007,-1331.0684449970722,-1222.8025078773499,-921.87374606728554,-852.18869522213936,661.71741411089897,262.4583013355732,1471.5777680277824,1287.8308996558189,763.91516402363777,-127.64201164245605,932.06250891089439,106.5400555729866,-670.94950526952744,177.51685976982117,-1485.1778075098991,-965.90443924069405,-267.43774861097336,544.81997564435005,83.581154048442841,-1506.2758855521679,165.91344475746155,1213.4608656167984,247.48211950063705,1599.5940171182156,1484.4125486910343],"y":[204.39467104151845,163.71469949372113,248.5410853754729,215.71334064938128,46.930652623996139,57.171872723847628,40.223291935399175,323.46006324514747,194.57984785549343,286.08933119103312,18.388790264725685,457.95105281285942,448.35426779463887,232.22861532121897,480.42064039036632,563.00829495303333,61.525196023285389,135.21696394309402,300.49426895566285,335.72917990386486,294.51341517269611,302.89984960108995,99.726326717063785,131.41187159344554,332.83632388338447,323.45803887583315,471.63924593478441,272.53131475299597,236.90274618566036,506.05154852382839,479.0223553776741,420.71666764095426,550.90749976225197,230.85947390645742,180.86661365814507,136.24396389350295,293.62137825228274,407.58653269149363,469.07018702477217,523.63356384448707,595.86745100095868,500.41738827712834,322.40180214866996,342.62067382223904,427.48819263651967,313.4057080373168,222.34361227601767,567.05395309254527,99.894211487844586,450.20312173292041],"mode":"markers","frame":"1","type":"scatter","name":"Random","marker":{"color":"rgba(252,141,98,1)","size":[25,70,25,70,85,85,100,10,25,100,10,55,10,70,25,55,40,25,10,100,40,100,10,100,55,40,10,70,40,55,10,85,10,55,10,100,55,85,10,85,40,55,100,100,100,70,40,85,100,100],"sizemode":"area","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)","size":[25,70,25,70,85,85,100,10,25,100,10,55,10,70,25,55,40,25,10,100,40,100,10,100,55,40,10,70,40,55,10,85,10,55,10,100,55,85,10,85,40,55,100,100,100,70,40,85,100,100]},"error_y":{"color":"rgba(252,141,98,1)","width":[]},"error_x":{"color":"rgba(252,141,98,1)","width":[]},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","visible":true}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"frames":[{"name":"1","data":[{"x":[-470.67747041583061,23.203881084918976,-255.73413521051407,617.90588647127151,386.79257407784462,-929.88394424319267,1457.2256281971931,-470.74553593993187,-722.20703512430191,-798.61548021435738,673.0136401951313,430.95153197646141,23.178030550479889,-599.05411601066589,-167.40104705095291,304.36807870864868,599.82218742370605,508.47419872879982,104.79078069329262,-338.95321190357208,1204.7875463962555,-869.85121592879295,433.74356403946877,1395.7807585597038,-1543.2431794703007,-1331.0684449970722,-1222.8025078773499,-921.87374606728554,-852.18869522213936,661.71741411089897,262.4583013355732,1471.5777680277824,1287.8308996558189,763.91516402363777,-127.64201164245605,932.06250891089439,106.5400555729866,-670.94950526952744,177.51685976982117,-1485.1778075098991,-965.90443924069405,-267.43774861097336,544.81997564435005,83.581154048442841,-1506.2758855521679,165.91344475746155,1213.4608656167984,247.48211950063705,1599.5940171182156,1484.4125486910343],"y":[204.39467104151845,163.71469949372113,248.5410853754729,215.71334064938128,46.930652623996139,57.171872723847628,40.223291935399175,323.46006324514747,194.57984785549343,286.08933119103312,18.388790264725685,457.95105281285942,448.35426779463887,232.22861532121897,480.42064039036632,563.00829495303333,61.525196023285389,135.21696394309402,300.49426895566285,335.72917990386486,294.51341517269611,302.89984960108995,99.726326717063785,131.41187159344554,332.83632388338447,323.45803887583315,471.63924593478441,272.53131475299597,236.90274618566036,506.05154852382839,479.0223553776741,420.71666764095426,550.90749976225197,230.85947390645742,180.86661365814507,136.24396389350295,293.62137825228274,407.58653269149363,469.07018702477217,523.63356384448707,595.86745100095868,500.41738827712834,322.40180214866996,342.62067382223904,427.48819263651967,313.4057080373168,222.34361227601767,567.05395309254527,99.894211487844586,450.20312173292041],"mode":"markers","frame":"1","type":"scatter","name":"Random","marker":{"color":"rgba(252,141,98,1)","size":[25,70,25,70,85,85,100,10,25,100,10,55,10,70,25,55,40,25,10,100,40,100,10,100,55,40,10,70,40,55,10,85,10,55,10,100,55,85,10,85,40,55,100,100,100,70,40,85,100,100],"sizemode":"area","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)","size":[25,70,25,70,85,85,100,10,25,100,10,55,10,70,25,55,40,25,10,100,40,100,10,100,55,40,10,70,40,55,10,85,10,55,10,100,55,85,10,85,40,55,100,100,100,70,40,85,100,100]},"error_y":{"color":"rgba(252,141,98,1)","width":[]},"error_x":{"color":"rgba(252,141,98,1)","width":[]},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","visible":true}],"traces":[0]},{"name":"2","data":[{"x":[-460.57638333931232,47.249709921298745,369.35738336094425,646.75479451361264,270.66135958778136,-925.77485554021348,1404.8074560576531,-534.04859065703386,-744.81166486452548,-1005.5845208463875,478.11273035475506,442.98681911056889,80.846964479849277,-583.90550506384943,-120.29551661624797,332.47822366082823,589.55387033353463,534.42458306980802,104.48542600074191,-625.03414932710803,1219.1824760711584,-1087.1917189016083,459.84656010962925,1500.6881608919355,-1482.2673537088665,-1351.7793718732116,-1414.5588291884387,-886.03331852466624,-1052.4925117149019,699.28901076618615,286.29915023530697,1503.9345267199681,1285.493749113579,767.64325432714202,-133.011715950792,956.00541507458126,29.723685424522742,-695.52990740777761,214.2147886621679,-1365.2523957426495,-950.43930070689953,-275.92502306144144,943.83822215113105,-358.34331241619896,-1471.0996117585908,796.70039577275611,1175.3684968708865,282.47500888016498,1515.1220542984081,1420.7834031319373],"y":[204.39602533056348,163.73068733059552,248.51585289171388,215.69597784281385,46.904094810539277,57.164294568136349,40.144783777746269,323.40585020099371,194.57085618650353,286.06245170782461,18.665219706230879,457.87991715107705,448.2788455065691,232.25012097086662,480.50736721300541,562.95592990402736,61.523787893694504,135.12442637106,300.48872860462586,335.84244072412855,294.4963389780537,302.7396795525471,99.723016128156544,131.31814479336239,332.83921839312779,323.45705868643824,471.66682677205512,272.60700143755935,237.6255036699512,506.06465412076352,479.05736337132998,420.70933829142058,550.90850596996154,230.86152162210578,180.86302965357405,136.23272220373781,293.7066181123709,407.5849451349402,468.9339185885774,523.83839938201106,595.88323943776845,500.42337411166693,321.7667553480681,342.34311287882525,427.37849322319141,313.81142693314104,222.3342099013457,567.07404779873104,99.806911571333615,450.08641404437225],"mode":"markers","frame":"2","type":"scatter","name":"Random","marker":{"color":"rgba(252,141,98,1)","size":[25,70,25,70,85,85,100,10,25,100,10,55,10,70,25,55,40,25,10,100,40,100,10,100,55,40,10,70,40,55,10,85,10,55,10,100,55,85,10,85,40,55,100,100,100,70,40,85,100,100],"sizemode":"area","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)","size":[25,70,25,70,85,85,100,10,25,100,10,55,10,70,25,55,40,25,10,100,40,100,10,100,55,40,10,70,40,55,10,85,10,55,10,100,55,85,10,85,40,55,100,100,100,70,40,85,100,100]},"error_y":{"color":"rgba(252,141,98,1)","width":[]},"error_x":{"color":"rgba(252,141,98,1)","width":[]},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","visible":true}],"traces":[0]}],"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="simulation.html#cb3-1" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">sim.dat</span>(<span class="dv">50</span>,<span class="dv">2</span>)</span>
<span id="cb3-2"><a href="simulation.html#cb3-2" tabindex="-1"></a>fig2 <span class="ot">&lt;-</span> df2 <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="simulation.html#cb3-3" tabindex="-1"></a>  <span class="fu">plot_ly</span>(</span>
<span id="cb3-4"><a href="simulation.html#cb3-4" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span>x,</span>
<span id="cb3-5"><a href="simulation.html#cb3-5" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">~</span>y,</span>
<span id="cb3-6"><a href="simulation.html#cb3-6" tabindex="-1"></a>    <span class="at">size =</span> <span class="sc">~</span>size,</span>
<span id="cb3-7"><a href="simulation.html#cb3-7" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span>level,</span>
<span id="cb3-8"><a href="simulation.html#cb3-8" tabindex="-1"></a>    <span class="at">frame =</span> <span class="sc">~</span>obs,</span>
<span id="cb3-9"><a href="simulation.html#cb3-9" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>,</span>
<span id="cb3-10"><a href="simulation.html#cb3-10" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&#39;markers&#39;</span>)</span>
<span id="cb3-11"><a href="simulation.html#cb3-11" tabindex="-1"></a>fig2</span></code></pre></div>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-3473f652e64e0350ff04" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-3473f652e64e0350ff04">{"x":{"visdat":{"4b4069886c10":["function () ","plotlyVisDat"]},"cur_data":"4b4069886c10","attrs":{"4b4069886c10":{"x":{},"y":{},"mode":"markers","color":{},"size":{},"frame":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"x","range":[-1735.1796384905333,1697.6978655999546]},"yaxis":{"domain":[0,1],"automargin":true,"title":"y","range":[-19.996843042317778,624.45667895721272]},"hovermode":"closest","showlegend":true,"sliders":[{"currentvalue":{"prefix":"obs: ","xanchor":"right","font":{"size":16,"color":"rgba(204,204,204,1)"}},"steps":[{"method":"animate","args":[["1"],{"transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":false},"mode":"immediate"}],"label":"1","value":"1"},{"method":"animate","args":[["2"],{"transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":false},"mode":"immediate"}],"label":"2","value":"2"}],"visible":true,"pad":{"t":40}}],"updatemenus":[{"type":"buttons","direction":"right","showactive":false,"y":0,"x":0,"yanchor":"top","xanchor":"right","pad":{"t":60,"r":5},"buttons":[{"label":"Play","method":"animate","args":[null,{"fromcurrent":true,"mode":"immediate","transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":false}}]}]}]},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[819.78187561035156,601.29842385649681,1356.9134958088398,631.20474368333817,292.65758097171783,1111.1252345144749,371.49637639522552,-697.23483920097351,539.3722303211689,1502.1513104438782,765.08407518267632,1330.6158438324928,-350.48766359686852,-1395.9808222949505,-1288.7567229568958,-1371.1566954851151,-362.33653575181961,-221.05503305792809,-600.02173110842705,687.71956712007523,-1407.4116162955761,-1579.1397519409657,720.60687020421028,514.90372717380524,-244.92767974734306,-1177.0390145480633,-1202.9438965022564,-1221.512633562088,-146.78537845611572,-129.7745555639267,1540.4658548533916,-16.169554740190506,-531.60776272416115,415.41969403624535,-64.376173168420792,536.92810013890266,593.5980312526226,79.6048603951931,-778.02592441439629,26.241243630647659,-18.582261353731155,-1289.5758971571922,728.87713089585304,-1268.9905941486359,-432.09538012742996,181.58759400248528,-929.98506873846054,-33.372276276350021,-314.07145112752914,-583.64353775978088],"y":[544.91366883739829,516.81910143233836,594.37049967236817,422.61218251660466,206.8908276502043,381.60390662960708,127.74652945809066,292.56254034116864,193.72452786192298,367.55905598402023,171.721644513309,337.09564777091146,500.570950191468,377.53603141754866,464.81876126490533,242.76254349388182,595.16333704814315,276.80594762787223,53.408331982791424,75.645982520654798,19.651503721252084,48.718466330319643,341.24866803176701,18.172603100538254,230.00506195239723,167.50218677334487,62.092675874009728,54.663202771916986,423.0477754957974,29.561938717961311,439.91107027977705,171.95566138252616,573.13888021744788,36.569778341799974,9.29649886675179,27.711263811215758,566.13211235962808,354.62565408088267,122.21191884018481,405.23061146959662,180.55693516507745,531.15624021738768,139.18045442551374,295.53275112994015,175.47901240177453,541.38669068925083,467.43481890298426,369.75916810333729,273.3678731136024,281.00651535205543],"mode":"markers","frame":"1","type":"scatter","name":"Avoidance","marker":{"color":"rgba(252,141,98,1)","size":[10,85,25,55,100,55,55,55,55,85,55,100,55,40,100,25,85,70,70,25,10,25,10,100,100,55,25,100,10,85,25,55,85,40,100,10,10,10,70,25,70,25,40,10,55,55,55,10,40,55],"sizemode":"area","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)","size":[10,85,25,55,100,55,55,55,55,85,55,100,55,40,100,25,85,70,70,25,10,25,10,100,100,55,25,100,10,85,25,55,85,40,100,10,10,10,70,25,70,25,40,10,55,55,55,10,40,55]},"error_y":{"color":"rgba(252,141,98,1)","width":[]},"error_x":{"color":"rgba(252,141,98,1)","width":[]},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","visible":true}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"frames":[{"name":"1","data":[{"x":[819.78187561035156,601.29842385649681,1356.9134958088398,631.20474368333817,292.65758097171783,1111.1252345144749,371.49637639522552,-697.23483920097351,539.3722303211689,1502.1513104438782,765.08407518267632,1330.6158438324928,-350.48766359686852,-1395.9808222949505,-1288.7567229568958,-1371.1566954851151,-362.33653575181961,-221.05503305792809,-600.02173110842705,687.71956712007523,-1407.4116162955761,-1579.1397519409657,720.60687020421028,514.90372717380524,-244.92767974734306,-1177.0390145480633,-1202.9438965022564,-1221.512633562088,-146.78537845611572,-129.7745555639267,1540.4658548533916,-16.169554740190506,-531.60776272416115,415.41969403624535,-64.376173168420792,536.92810013890266,593.5980312526226,79.6048603951931,-778.02592441439629,26.241243630647659,-18.582261353731155,-1289.5758971571922,728.87713089585304,-1268.9905941486359,-432.09538012742996,181.58759400248528,-929.98506873846054,-33.372276276350021,-314.07145112752914,-583.64353775978088],"y":[544.91366883739829,516.81910143233836,594.37049967236817,422.61218251660466,206.8908276502043,381.60390662960708,127.74652945809066,292.56254034116864,193.72452786192298,367.55905598402023,171.721644513309,337.09564777091146,500.570950191468,377.53603141754866,464.81876126490533,242.76254349388182,595.16333704814315,276.80594762787223,53.408331982791424,75.645982520654798,19.651503721252084,48.718466330319643,341.24866803176701,18.172603100538254,230.00506195239723,167.50218677334487,62.092675874009728,54.663202771916986,423.0477754957974,29.561938717961311,439.91107027977705,171.95566138252616,573.13888021744788,36.569778341799974,9.29649886675179,27.711263811215758,566.13211235962808,354.62565408088267,122.21191884018481,405.23061146959662,180.55693516507745,531.15624021738768,139.18045442551374,295.53275112994015,175.47901240177453,541.38669068925083,467.43481890298426,369.75916810333729,273.3678731136024,281.00651535205543],"mode":"markers","frame":"1","type":"scatter","name":"Avoidance","marker":{"color":"rgba(252,141,98,1)","size":[10,85,25,55,100,55,55,55,55,85,55,100,55,40,100,25,85,70,70,25,10,25,10,100,100,55,25,100,10,85,25,55,85,40,100,10,10,10,70,25,70,25,40,10,55,55,55,10,40,55],"sizemode":"area","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)","size":[10,85,25,55,100,55,55,55,55,85,55,100,55,40,100,25,85,70,70,25,10,25,10,100,100,55,25,100,10,85,25,55,85,40,100,10,10,10,70,25,70,25,40,10,55,55,55,10,40,55]},"error_y":{"color":"rgba(252,141,98,1)","width":[]},"error_x":{"color":"rgba(252,141,98,1)","width":[]},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","visible":true}],"traces":[0]},{"name":"2","data":[{"x":[900.303399653361,519.3278759630623,1371.6170428079802,654.47478714400984,420.58780860020329,1183.5207433085329,399.47996721068989,-825.08402466788209,763.81246860895703,1514.7833682621833,900.21545138525516,1365.5474961899624,-544.79875867592978,-1400.3484846413098,-1308.9607565172739,-1383.9852562170706,-568.3391300292169,-435.93455720745521,-627.34467653860054,861.63002714917957,-1413.799940607538,-1579.1397519409657,808.24901931799104,516.6967259326027,-258.58858731226474,-1187.3082800927575,-1218.0997231989909,-1308.3775191464388,-255.11010137796302,-195.93980191333205,1541.657979050387,-142.74470025739038,-578.97252198952424,634.54161057395572,-204.13277529845834,790.66197506081267,743.2608454754868,226.52007512624849,-904.08972729613265,-18.039162304820167,-140.42270101119016,-1282.410618923303,766.94080781284049,-1290.4148900875605,-692.84203734330185,303.81988036039581,-931.80357100413141,-385.79844665093958,-469.66163228280561,-674.11981901960075],"y":[544.91122606610656,516.91372141995157,594.36986962485162,422.65905600721834,206.82673438865859,381.59658233237496,127.76099688076953,292.66122036973019,193.73544471841788,367.56069827358965,171.72203216692719,337.08373604892734,500.61076286951629,377.52957075930823,464.82575393641673,242.76091027749675,595.15963150381697,276.70193440737592,53.410256779876804,75.627090819777081,19.653478779585097,48.718466330319643,341.25211453410435,18.172644696075952,230.00254547214567,167.50242498555045,62.093419384694322,54.667614199349295,423.02370052002817,29.562986817779951,439.91198937534756,172.06631685653869,573.29613730163589,36.584416064188453,9.3033428859080871,27.740736828881918,566.13924902319616,354.67792761655807,122.20457452574173,404.99503579724626,180.56764677022105,531.19618189623861,139.17870588657968,295.56528256123403,175.54225167012703,541.39999519011144,467.4362935892554,369.77565495313087,273.36013414627524,280.99587841954099],"mode":"markers","frame":"2","type":"scatter","name":"Avoidance","marker":{"color":"rgba(252,141,98,1)","size":[10,85,25,55,100,55,55,55,55,85,55,100,55,40,100,25,85,70,70,25,10,25,10,100,100,55,25,100,10,85,25,55,85,40,100,10,10,10,70,25,70,25,40,10,55,55,55,10,40,55],"sizemode":"area","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)","size":[10,85,25,55,100,55,55,55,55,85,55,100,55,40,100,25,85,70,70,25,10,25,10,100,100,55,25,100,10,85,25,55,85,40,100,10,10,10,70,25,70,25,40,10,55,55,55,10,40,55]},"error_y":{"color":"rgba(252,141,98,1)","width":[]},"error_x":{"color":"rgba(252,141,98,1)","width":[]},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","visible":true}],"traces":[0]}],"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="imperfect-matching" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Imperfect Matching<a href="simulation.html#imperfect-matching" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Mark recapture methods also assume that the observers can perfectly identify which animals were seen by both observers and which animals were seen by just one observer. This becomes problematic for animals without unique identifying markings in surveys where they could move between detection occasions.</p>
<p>We simulated imperfect matching by setting any animals detected on the second occasion within 300m of an animal detected on the first animal were recorded as the same animal, taking the closest as the match if there were multiple within this range. Any animals further than 1000m were recorded as different, and the probability of matching animals within the range was generated using a inverse power function with parameters <span class="math inline">\(\beta_1\)</span> = 6, <span class="math inline">\(\beta_2\)</span> = 0.000005. (Thanks to the snow leopard prey team for suggesting these limits)</p>
<p><img src="_main_files/figure-html/imperfect-matching%20plot-1.png" width="672" /></p>
</div>
</div>
<div id="simulation-results" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Simulation Results<a href="simulation.html#simulation-results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For each of the 12 scenarios we calculated the bias and coverage probability of the 4 methods. Due to time constraints we only fitted a hazard-rate detection function with no adjustments for conventional distance sampling and only used the independent observer configuration with a hazard rate distance model for MRDS. This means the models for these methods may not be the best fit, and it could be possible to achieve a smaller bias or larger coverage probability. With more time we would fit multiple models to each set of simulated data and choose the best using AIC. We also only fit one 2D model, but as it was the model used the generate the data it should be the best model regardless.</p>
<div id="uniform-animal-distribution" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Uniform Animal Distribution<a href="simulation.html#uniform-animal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With uniform animal distribution we expect conventional distance and 2D distance sampling to perform similarly, as all the assumptions for both methods are met. Our results show that they both have similar coverage probabilities, and whilst conventional distance may appear to be more biased, this is more likely a result of only fitting one model rather than performing model selection. As these methods involve walking the transect just once, they are not affected by movement between observers.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="simulation.html#cb4-1" tabindex="-1"></a><span class="co"># Scenario 2</span></span>
<span id="cb4-2"><a href="simulation.html#cb4-2" tabindex="-1"></a><span class="co"># Initial density: uniform + Movement: avoidance + Matching: imperfect</span></span>
<span id="cb4-3"><a href="simulation.html#cb4-3" tabindex="-1"></a><span class="co">#sc2 &lt;- simulation(n=600, b=99, 0, 0, TRUE)</span></span>
<span id="cb4-4"><a href="simulation.html#cb4-4" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;sc2.RData&quot;</span>)</span>
<span id="cb4-5"><a href="simulation.html#cb4-5" tabindex="-1"></a>sc2.table <span class="ot">&lt;-</span> <span class="fu">kable</span>(sc2.out <span class="ot">&lt;-</span> <span class="fu">result</span>(sc2, <span class="at">n=</span><span class="dv">600</span>), <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Bias&quot;</span>, <span class="st">&quot;Coverage Probability&quot;</span>), <span class="at">caption =</span> <span class="st">&quot;Avoidance Movement&quot;</span>)</span></code></pre></div>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<caption>(#tab:Sc.3)Random Movement</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Bias</th>
<th align="right">Coverage Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MR</td>
<td align="right">-0.5712948</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">DS</td>
<td align="right">-0.2426987</td>
<td align="right">0.8686869</td>
</tr>
<tr class="odd">
<td align="left">MRDS</td>
<td align="right">-0.2327096</td>
<td align="right">0.5050505</td>
</tr>
<tr class="even">
<td align="left">2D</td>
<td align="right">-0.0241737</td>
<td align="right">0.8315789</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<caption>(#tab:Sc.1)Avoidance Movement</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Bias</th>
<th align="right">Coverage Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MR</td>
<td align="right">-0.5371078</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">DS</td>
<td align="right">-0.1746048</td>
<td align="right">0.9090909</td>
</tr>
<tr class="odd">
<td align="left">MRDS</td>
<td align="right">-0.1492886</td>
<td align="right">0.7979798</td>
</tr>
<tr class="even">
<td align="left">2D</td>
<td align="right">0.0442049</td>
<td align="right">0.8541667</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>Mark recapture performs poorly in this scenario and all the other scenarios as detectability declines with distance. This means there is unmodelled heterogeneity in the population, so it is negatively biased. MRDS is negatively biased with random animal movement as this violates the assumption that each animal has the same detection probability for each observer. It is less negatively biased with avoidance as second observer will see less animals than the first due to them now being further away. This results in a lower estimated detection probability and therefore a higher estimate.</p>
<table class="kable_wrapper">
<caption>
(#tab:Sc.4)With Imperfect Matching
</caption>
<tbody>
<tr>
<td>
<table>
<caption>(#tab:Sc.4)Random Movement</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Bias</th>
<th align="right">Coverage Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MR</td>
<td align="right">-0.7921806</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">DS</td>
<td align="right">-0.1992975</td>
<td align="right">0.8585859</td>
</tr>
<tr class="odd">
<td align="left">MRDS</td>
<td align="right">-0.1449946</td>
<td align="right">0.7474747</td>
</tr>
<tr class="even">
<td align="left">2D</td>
<td align="right">0.0114371</td>
<td align="right">0.8163265</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<caption>(#tab:Sc.2)Avoidance Movement</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Bias</th>
<th align="right">Coverage Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MR</td>
<td align="right">-0.7960944</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">DS</td>
<td align="right">-0.2301179</td>
<td align="right">0.9090909</td>
</tr>
<tr class="odd">
<td align="left">MRDS</td>
<td align="right">0.0069158</td>
<td align="right">0.9494949</td>
</tr>
<tr class="even">
<td align="left">2D</td>
<td align="right">0.0007698</td>
<td align="right">0.8453608</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>After introducing imperfect matching, MRDS estimates seem to be less negatively biased. This is due to some individuals that were seen twice being mistakenly identified as two separate animals, leading to a lower estimate of detection probability and hence a higher estimate of abundance. Whilst it looks like MRDS should be the best estimator in the scenario with avoidance movement and imperfect matching, this is actually because effects of breaking multiple assumptions happen to balance out in this specific situation. This results in very variable estimates, as the variance of the <span class="math inline">\(N\hat\)</span>s was <code>{r var(sc2[[3]]$N.hat[sc2[[3]]$N.hat &lt; 3*600])/99}</code> for MRDS, compared to <code>{r var(sc2[[4]]$N.hat[sc2[[4]]$N.hat &lt; 3*600])/99}</code> for 2D Distance.</p>
</div>
<div id="avoiding-transect" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Avoiding Transect<a href="simulation.html#avoiding-transect" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As expected, only 2D Distance is unbiased when the animals initially avoid the transect.</p>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<caption>(#tab:Sc.7)Random Movement</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Bias</th>
<th align="right">Coverage Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MR</td>
<td align="right">-0.5236447</td>
<td align="right">0.0202020</td>
</tr>
<tr class="even">
<td align="left">DS</td>
<td align="right">-0.8951007</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">MRDS</td>
<td align="right">-0.7777289</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">2D</td>
<td align="right">-0.0242510</td>
<td align="right">0.9325843</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<caption>(#tab:Sc.5)Avoidance Movement</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Bias</th>
<th align="right">Coverage Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MR</td>
<td align="right">-0.4813794</td>
<td align="right">0.1818182</td>
</tr>
<tr class="even">
<td align="left">DS</td>
<td align="right">-0.8971265</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">MRDS</td>
<td align="right">-0.7722739</td>
<td align="right">0.0102041</td>
</tr>
<tr class="even">
<td align="left">2D</td>
<td align="right">-0.0100226</td>
<td align="right">0.9625000</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>Conventional distance and MRDS are both negatively biased as the fitted detection function decays less quickly than the true detection function to account for the large numbers of detections far away from the transect. However, as these detections are a result of more animals being far from the transect rather than a high detection probability, the models overestimate the detection probability and so underestimate the abundance.</p>
<div class="figure"><span style="display:block;" id="fig:avoidance-df-hist"></span>
<img src="_main_files/figure-html/avoidance-df-hist-1.png" alt="Fitted detection function vs True detection function" width="672" />
<p class="caption">
Figure 3.2: Fitted detection function vs True detection function
</p>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="simulation.html#cb5-1" tabindex="-1"></a><span class="co"># Scenario 8</span></span>
<span id="cb5-2"><a href="simulation.html#cb5-2" tabindex="-1"></a><span class="co"># Initial density: avoiding + Movement: random + Matching: imperfect</span></span>
<span id="cb5-3"><a href="simulation.html#cb5-3" tabindex="-1"></a><span class="co">#sc8 &lt;- simulation(n=1200, b=99, 1, 1, TRUE)</span></span>
<span id="cb5-4"><a href="simulation.html#cb5-4" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;sc8.RData&quot;</span>)</span>
<span id="cb5-5"><a href="simulation.html#cb5-5" tabindex="-1"></a>sc8.table <span class="ot">&lt;-</span> <span class="fu">kable</span>(sc8.out <span class="ot">&lt;-</span> <span class="fu">result</span>(sc8, <span class="at">n=</span><span class="dv">1200</span>), <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Bias&quot;</span>, <span class="st">&quot;Coverage Probability&quot;</span>), <span class="at">caption =</span> <span class="st">&quot;Random Movement&quot;</span>)</span>
<span id="cb5-6"><a href="simulation.html#cb5-6" tabindex="-1"></a><span class="fu">kables</span>(<span class="fu">list</span>(sc8.table,sc6.table), <span class="at">caption =</span> <span class="st">&quot;With Imperfect Matching&quot;</span>)</span></code></pre></div>
<table class="kable_wrapper">
<caption>
(#tab:Sc.8)With Imperfect Matching
</caption>
<tbody>
<tr>
<td>
<table>
<caption>(#tab:Sc.8)Random Movement</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Bias</th>
<th align="right">Coverage Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MR</td>
<td align="right">-0.8963410</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">DS</td>
<td align="right">-0.8946835</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">MRDS</td>
<td align="right">-0.8838497</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">2D</td>
<td align="right">-0.0489940</td>
<td align="right">0.9550562</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<caption>(#tab:Sc.6)Avoidance Movement</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Bias</th>
<th align="right">Coverage Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MR</td>
<td align="right">-0.9036200</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">DS</td>
<td align="right">-0.8972843</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">MRDS</td>
<td align="right">-0.8280747</td>
<td align="right">0.0425532</td>
</tr>
<tr class="even">
<td align="left">2D</td>
<td align="right">-0.1057635</td>
<td align="right">0.9638554</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>As before, all the methods except 2D distance sampling are negatively biased. The imperfect matching does make the MRDS estimates slightly bigger, but not enough to counteract the negative bias from the non uniform distribution.</p>
</div>
<div id="attracted-to-transect" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Attracted to Transect<a href="simulation.html#attracted-to-transect" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As with the avoidance case, we expect only 2D Distance to be unbiased when animals are initially attracted to the line.</p>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<caption>(#tab:Sc.11)Random Movement</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Bias</th>
<th align="right">Coverage Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MR</td>
<td align="right">-0.3703866</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">DS</td>
<td align="right">0.5170905</td>
<td align="right">0.0202020</td>
</tr>
<tr class="odd">
<td align="left">MRDS</td>
<td align="right">0.5902227</td>
<td align="right">0.0202020</td>
</tr>
<tr class="even">
<td align="left">2D</td>
<td align="right">0.2672576</td>
<td align="right">0.2828283</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<caption>(#tab:Sc.9)Avoidant Movement</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Bias</th>
<th align="right">Coverage Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MR</td>
<td align="right">-0.3494140</td>
<td align="right">0.0101010</td>
</tr>
<tr class="even">
<td align="left">DS</td>
<td align="right">0.5820032</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">MRDS</td>
<td align="right">0.6244091</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">2D</td>
<td align="right">0.2470833</td>
<td align="right">0.3131313</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>Conventional distance and MRDS are positively biased this time, as the fitted detection functions now decay quicker than the true function. This gives a lower detection probability and therefore a higher estimate.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="simulation.html#cb6-1" tabindex="-1"></a><span class="co"># Scenario 12</span></span>
<span id="cb6-2"><a href="simulation.html#cb6-2" tabindex="-1"></a><span class="co"># Initial density: attracted + Movement: random + Matching: imperfect</span></span>
<span id="cb6-3"><a href="simulation.html#cb6-3" tabindex="-1"></a><span class="co">#sc12 &lt;- simulation(n=400, b=99, 2, 1, TRUE)</span></span>
<span id="cb6-4"><a href="simulation.html#cb6-4" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;sc12.Rdata&quot;</span>)</span>
<span id="cb6-5"><a href="simulation.html#cb6-5" tabindex="-1"></a>sc12.table <span class="ot">&lt;-</span> <span class="fu">kable</span>(sc12.out <span class="ot">&lt;-</span> <span class="fu">result</span>(sc12, <span class="at">n=</span><span class="dv">400</span>), <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Bias&quot;</span>, <span class="st">&quot;Coverage Probability&quot;</span>), <span class="at">caption =</span> <span class="st">&quot;Random Movement&quot;</span>)</span>
<span id="cb6-6"><a href="simulation.html#cb6-6" tabindex="-1"></a><span class="fu">kables</span>(<span class="fu">list</span>(sc12.table,sc10.table), <span class="at">caption =</span> <span class="st">&quot;With Imperfect Matching&quot;</span>)</span></code></pre></div>
<table class="kable_wrapper">
<caption>
(#tab:Sc.12)With Imperfect Matching
</caption>
<tbody>
<tr>
<td>
<table>
<caption>(#tab:Sc.12)Random Movement</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Bias</th>
<th align="right">Coverage Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MR</td>
<td align="right">-0.6407544</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">DS</td>
<td align="right">0.5726782</td>
<td align="right">0.0101010</td>
</tr>
<tr class="odd">
<td align="left">MRDS</td>
<td align="right">0.6222090</td>
<td align="right">0.1212121</td>
</tr>
<tr class="even">
<td align="left">2D</td>
<td align="right">0.2494046</td>
<td align="right">0.2783505</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<caption>(#tab:Sc.10)Avoidant Movement</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Bias</th>
<th align="right">Coverage Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MR</td>
<td align="right">-0.6362617</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">DS</td>
<td align="right">0.5949428</td>
<td align="right">0.0202020</td>
</tr>
<tr class="odd">
<td align="left">MRDS</td>
<td align="right">1.1271412</td>
<td align="right">0.0202020</td>
</tr>
<tr class="even">
<td align="left">2D</td>
<td align="right">0.2617803</td>
<td align="right">0.3131313</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="further-reading-1" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Further Reading<a href="simulation.html#further-reading-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Johansson, ., Mishra, C., Chapron, G., Samelius, G., Lkhagvajav, P., McCarthy, T. and Low, M. (2022). Seasonal variation in daily activity patterns of snow leopards and their prey. Scientific Reports, [online] 12(1), p.21681. <a href="doi:https://doi.org/10.1038/s41598-022-26358-w" class="uri">doi:https://doi.org/10.1038/s41598-022-26358-w</a>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cross.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="real-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
